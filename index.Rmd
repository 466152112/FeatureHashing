---
title       : Introduction of Feature Hashing
subtitle    : Creates a Model Matrix via Feature Hashing With a Formula Interface
author      : Wush Wu
job         : Taiwan R User Group
framework   : io2012-wush
highlighter : highlight.js
hitheme     : zenburn
widgets     : [mathjax]            # {mathjax, quiz, bootstrap}
mode        : selfcontained # {standalone, draft}
knit        : slidify::knit2slides
---

```{r setup, include=FALSE, cache=FALSE}
suppressPackageStartupMessages({
  library(knitr)
  library(ggplot2)
})
opts_chunk$set(echo = FALSE, cache = FALSE)
```

## Outline

1. Feature Vectorization in R
1. Distributed Feature Vectorization in R
1. Handling New Feature
1. Feature Hashing
1. Linear Regression with Feature Hashing
1. Logistic Regression with Feature Hashing
1. Gradient Boosted Decision Tree with Feature Hashing

--- .segue .dark

## Feature Vectorization in R

--- &vcenter .largecontent

## Feature Vectorization

- Lots of machine learning algorithm involves numerical matrix
    - Linear Regression
    - Logistic Regression
    - Support Vector Machine
    - Decision Tree

--- &vcenter .largecontent

## Linear Regression

```{r lr, cache = TRUE}
# http://stackoverflow.com/questions/7549694/ggplot2-adding-regression-line-equation-and-r2-on-graph
df <- data.frame(x = c(1:100))
df$y <- 2 + 3 * df$x + rnorm(100, sd = 40)
p <- ggplot(data = df, aes(x = x, y = y)) +
            geom_smooth(method = "lm", se=FALSE, color="black", formula = y ~ x) +
            geom_point()
lm_eqn = function(df){
    m = lm(y ~ x, df);
    eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2, 
         list(a = format(coef(m)[1], digits = 2), 
              b = format(coef(m)[2], digits = 2), 
             r2 = format(summary(m)$r.squared, digits = 3)))
    as.character(as.expression(eq));                 
}
g <- lm(y ~ ., df)
p + geom_text(aes(x = 25, y = 300, label = lm_eqn(df)), parse = TRUE)
```

--- &vcenter .largecontent

## Linear Regression

$$X = \begin{bmatrix}
1 & 1\\
1 & 2\\
1 & 3\\
\vdots \end{bmatrix},
y = \begin{bmatrix}
`r df$y[1]`\\
`r df$y[2]`\\
`r df$y[3]`\\
\vdots \end{bmatrix}$$

$$\begin{bmatrix}
`r format(coef(g)[1], digits = 2)`\\
`r format(coef(g)[2], digits = 2)` \end{bmatrix}
= (X^T X)^{-1}X y$$

--- &vcenter .largecontent

## IPinYou Dataset

- A Competition of Real Time Bidding in 2013

<http://data.computational-advertising.org/>

```{r load_ipinyou, echo=FALSE}
library(bit64)
library(data.table)
library(magrittr)
suppressWarnings({
  imp.20130606 <- fread("imp.20130606.part.txt", sep = "\t", select = c(2, 6)) %>% `colnames<-`(c("time", "ip"))
  imp.20130607 <- fread("imp.20130607.part.txt", sep = "\t", select = c(2, 6)) %>% `colnames<-`(c("time", "ip"))
})
```

--- .segue .dark

## Distributed Feature Vectorization in R



--- .segue .dark

## Handling New Feature

--- .segue .dark

## Feature Hashing

--- .segue .dark

## Linear Regression with Feature Hashing

--- .segue .dark

## Logistic Regression with Feature Hashing

--- .segue .dark

## Gradient Boosted Decision Tree with Feature Hashing
